#### [ACM-ICPC 2018 南京赛区网络预赛 J Sum](https://nanti.jisuanke.com/t/30999)

&ensp; 题目大意: 定义f(x)为将x分解为两个数相乘的种数, 其中两个数都不能是任何某个平方的倍数, 统计f(x)前缀和

&ensp; 预处理素数表, 分解质因数, 本地打表

```cpp
#include <bits/stdc++.h>
using namespace std;
const int MAXN = 2e7+10;

vector<int> prime;
bool vis[MAXN];
void preDeal()
{
	for( int i = 2; i < MAXN; i++ )
	{
		if( !vis[i]) prime.push_back(i);
		for( int j = 0; j < prime.size() && i*prime[j] < MAXN; j++ )
		{
			int &pr = prime[j];
			vis[i *pr] = 1;
			if( i %pr == 0 ) break;
		}
	}
}

int tab[] = {0,91191,192584,297950,405683,515459,626633,739045,852483,966912,1082052,1198114,1314718,1432028,1549817,1668193,1787135,1906390,2026146,2146136,2266667,2387549,2508871,2630462,2752371,2874639,2997158,3120032,3243119,3366520,3489932,3613936,3738181,3862490,3986994,4111735,4236737,4361698,4487066,4612686,4738511,4864289,4990388,5116664,5243229,5369867,5496754,5623791,5750870,5878078,6005474,6133203,6260885,6388725,6516762,6644824,6773127,6901373,7029992,7158539,7287263,7416284,7545416,7674449,7803782,7933207,8062722,8192274,8321906,8451805,8581801,8712055,8842096,8972275,9102547,9232961,9363554,9494157,9625004,9755938,9886950,10017983,10148844,10280203,10411389,10542883,10674240,10805861,10937504,11069223,11201007,11332921,11464883,11597052,11729193,11861262,11993705,12126025,12258400,12391040,12523516,12656166,12789067,12921848,13054579,13187504,13320508,13453602,13586774,13719869,13853247,13986514,14120008,14253309,14386885,14520392,14654166,14788025,14921887,15055781,15189684,15323818,15457662,15591829,15726171,15860307,15994523,16128806,16263185,16397659,16532492,16666832,16801580,16936281,17071064,17205892,17340555,17475663,17610633,17745712,17880846,18015903,18151158,18286380,18421709,18557022,18692444,18827784,18963400,19098848,19234290,19370154,19505801,19641642,19777519,19913314,20049275,20185285,20321385,20457277,20593338,20729330,20865650,21001835,21138111,21274436,21410818,21547076,21683484,21820144,21956598,22093104,22229668,22366325,22503073,22639973,22776638,22913339,23050191,23187142,23324126,23461131,23598181,23735094,23872307,24009642,24146811,24283975,24421331,24558490,24695920,24833370,24970658,25108380,25245874,25383395,25520950,25658587,25796374,25933934,26071797,26209372,26347174,26485076,26622902,26760824,26898791,27036594,27174566,27312740,27450706,27588857,27726961,27865373,28003600,28141911,28280152,28418433,28556760,28695275,28833776,28972150,29110608,29249091,29387803,29526153,29664850,29803499,29942284,30080989,30219657,30358441,30497293,30636082,30775130,30914174,31053104,31192185,31331179,31470167,31609415,31748423,31887517,32026828,32165782,32305187,32444202,32583567,32723079,32862322,33001587,33141122,33280440,33420074,33559362,33698999,33838507,33978065,34117622,34257522,34397226,34536661,34676502,34816149,34956127,35095848,35235542,35375439,35515410,35655575,35795501,35935339,36075391,36215350,36355393,36495439,36635633,36775711,36916012,37056227,37196391,37336429,37476732,37617135,37757288,37897612,38038091,38178409,38318810,38459587,38599776,38740415,38881066,39021547,39162099,39302705,39443464,39584051,39724915,39865626,40006151,40146977,40287863,40428460,40569451,40710205,40851206,40992128,41133137,41274028,41415033,41555943,41696924,41837952,41978974,42120055,42261305,42402400,42543639,42684646,42825817,42967172,43108426,43249727,43390980,43532316,43673762,43814989,43956666,44097954,44239427,44380881,44522226,44663695,44805229,44946860,45088495,45230120,45371706,45513056,45654977,45796647,45938348,46080066,46221808,46363380,46505311,46647022,46788960,46930828,47072832,47214676,47356530,47498548,47640580,47782512,47924317,48066408,48208385,48350702,48492552,48634691,48776827,48919087,49061103,49203373,49345532,49487866,49630130,49772221,49914651,50056820,50199195,50341562,50483836,50626208,50768729,50911134,51053475,51195973,51338440,51480965,51623499,51765768,51908365,52051111,52193913,52336497,52479158,52621807,52764502,52907210,53049928,53192609,53335384,53478115,53621006,53763585,53906422,54049364,54192317,54335120,54478028,54620923,54763944,54906935,55049697,55192838,55335558,55478807,55621747,55764926,55907766,56050963,56194062,56337238,56480274,56623611,56766825,56909847,57053115,57196411,57339678,57482917,57626022,57769615,57912877,58056130,58199701,58343118,58486498,58629964,58773249,58916819,59060235,59203647,59347222,59490677,59634222,59777824,59921614,60064858,60208648,60352185,60495915,60639464,60783150,60926743,61070642,61214340,61357908,61501513,61645456,61789206,61932989,62076746,62220699,62364486,62508643,62652459,62796349,62940349,63084069,63228003,63372037,63515901,63660053,63803866,63947993,64092125,64236371,64380477,64524477,64668423,64812800,64956959,65100977,65245142,65389247,65533416,65677798,65821996,65966074,66110248,66254519,66399186,66543366,66687600,66831968,66976166,67120862,67265138,67409442,67554055,67698299,67842834,67987278,68131697,68276114,68420632,68565048,68709650,68854138,68998745,69143248,69287931,69432848,69577434,69721871,69866611,70011171,70155850,70300739,70445274,70589900,70734500,70879371,71024209,71169053,71313725,71458556,71603102,71748132,71892983,72037927,72182729,72327796,72472554,72617625,72762388,72907273,73052262,73197094,73342116,73486968,73632087,73777177,73922188,74067536,74212464,74357683,74502745,74647861,74792963,74938225,75083101,75228316,75373591,75518697,75663847,75809049,75954194,76099535,76244754,76389994,76535454,76680808,76826046,76971173,77116510,77262002,77407256,77552719,77698216,77843549,77988837,78134416,78279838,78425266,78570584,78716167,78861744,79007245,79152529,79297939,79443646,79589033,79734777,79880557,80026238,80171764,80317482,80462978,80608676,80754466,80900032,81045697,81191446,81337211,81482872,81628645,81774614,81920283,82065982,82211988,82357839,82503598,82649359,82795201,82941043,83086965,83232548,83378618,83524496,83670649,83816563,83962307,84108420,84254311,84400044,84546074,84692417,84838331,84984096,85130278,85276199,85422241,85568254,85714239,85860209,86006640,86152578,86298624,86444891,86590933,86737044,86883323,87029555,87175481,87321800,87467829,87614118,87760320,87906638,88052921,88199162,88345588,88491708,88638118,88784453,88930771,89077151,89223711,89370147,89516702,89662872,89809334,89955806,90102144,90248608,90395246,90541384,90687905,90834558,90980808,91127436,91274122,91420449,91567149,91713580,91860200,92006758,92153454,92300126,92446616,92593107,92739781,92886382,93033160,93179983,93326521,93473157,93620081,93766590,93913377,94060017,94206877,94353584,94500093,94647161,94793799,94940822,95087544,95234464,95381357,95528286,95674913,95821893,95968753,96115545,96262289,96409162,96556143,96703028,96850035,96997002,97143964,97290774,97437883,97584945,97731999,97878973,98025999,98172713,98319931,98467044,98614361,98761451,98908552,99055416,99202624,99349772,99496636,99643973,99791181,99938273,100085415,100232793,100379804,100527100,100674252,100821582,100968619,101115933,101263187,101410246,101557578,101705008,101852122,101999356,102146913,102294429,102441574,102588905,102736154,102883573,103031064,103178493,103325674,103473095,103620580,103767815,103915454,104062960,104210246,104357668,104505191,104652465,104799939,104947458,105094758,105242526,105390106,105537534,105685211,105832766,105980239,106127850,106275479,106423263,106570618,106718078,106865990,107013379,107161174,107308707,107456349,107604179,107751958,107899605,108047213,108194934,108342712,108490440,108638203,108785759,108933593,109081468,109229063,109377036,109524765,109672495,109820393,109968295,110116161,110264063,110412050,110559823,110707725,110855570,111003608,111151301,111299408,111447224,111595251,111743115,111890732,112038784,112186735,112334773,112482705,112630659,112778820,112926930,113074903,113222949,113371030,113519266,113667319,113815127,113963461,114111405,114259458,114407554,114555948,114703918,114851906,114999975,115148380,115296384,115444677,115592864,115741084,115889166,116037255,116185551,116333832,116482178,116630435,116778605,116926939,117075173,117223337,117371600,117520084,117668315,117816531,117965073,118113226,118261589,118409893,118558409,118706805,118854963,119003413,119151813,119300114,119448511,119596893,119745484,119893760,120042420,120190538,120339200,120487438,120636335,120784764,120933108,121081536,121229979,121378410,121527010,121675769,121824287,121972670,122121352,122270133,122418781,122567412,122715770,122864439,123013342,123161687,123310455,123459262,123607937,123756357,123904959,124053749,124202370,124351348,124499721,124648565,124797055,124945875,125094613,125243298,125392268,125541125,125689768,125838415,125987181,126136179,126284954,126433879,126582686,126731306,126880367,127029238,127178359,127326887,127475516,127624443,127773478,127922523,128071185,128220210,128369194,128518097,128666966,128815861,128964836,129113782,129262728,129411579,129560464,129709890,129858844,130007765,130156744,130305949,130454797,130603970,130753047,130902013,131051141,131200246,131349277,131498403,131647575,131796683,131945984,132095101,132243983,132392959,132542420,132691487,132840590,132989730,133138967,133288266,133437247,133586542,133735904,133885114,134034243,134183194,134332619,134482155,134631328,134780630,134929725,135079057,135228557,135377685,135527073,135676226,135825639,135974916,136124126,136273533,136422830,136572346,136721579,136870983,137020541,137169730,137319261,137468575,137618056,137767667,137916975,138066435,138215842,138365223,138514567,138664168,138813652,138963046,139112701,139262321,139411658,139561398,139710957,139860469,140009932,140159383,140308623,140458283,140607936,140757535,140907216,141056924,141206196,141356002,141505504,141655103,141804948,141954344,142103989,142253693};

int block = 2e4;

int calculate(int x)
{
    long long ret = 1;
    for( int pr :prime)
    {
        if( pr *pr > x) break;

        int cnt = 0;
        while(x %pr == 0)
            x /= pr, cnt ++;

        if( cnt >= 3 ) { x = 1, ret = 0; break; }
        else if( cnt == 2 ) ret *= 1;
        else if( cnt == 1 ) ret *= 2;
    }

    if( x != 1) ret *= 2;
    return ret;
}

int N;

int main()
{
    ios::sync_with_stdio(0);
    cin.tie(0);

    preDeal();
    int T;  cin >> T;
    while(T--)
    {
        cin >> N;
        long long ans = tab[N/block];
        for( int x = N/block*block+1; x <= N; x++ )
            ans += calculate(x);
        cout << ans << endl;
    }
    return 0;
}

```


```cpp
//打表程序

#include <bits/stdc++.h>
using namespace std;
const int MAXN = 2e7+10;

vector<int> prime;
bool vis[MAXN];
void preDeal()
{
	for( int i = 2; i < MAXN; i++ )
	{
		if( !vis[i]) prime.push_back(i);
		for( int j = 0; j < prime.size() && i*prime[j] < MAXN; j++ )
		{
			int &pr = prime[j];
			vis[i *pr] = 1;
			if( i %pr == 0 ) break;
		}
	}
}

int main()
{
	ios::sync_with_stdio(0);
	cout.tie(0);

	freopen("out", "w", stdout);

	preDeal();
	long long sum = 0;
	int block = 2e4;
	for( int x = 1; x < MAXN; x++ )
	{
		int t = x;
		long long ans = 1;
		for( int pr :prime)
		{
			if( pr *pr > x) break;

			int cnt = 0;
			while(t %pr == 0)
				t /= pr, cnt ++;

			if( cnt >= 3 ) { t = 1, ans = 0; break; }
			else if( cnt == 2 ) ans *= 1;
			else if( cnt == 1 ) ans *= 2;
		}

		if( t != 1) ans *= 2;
		sum += ans;

		if( x %block == 0) cout << sum << ",";
	}
	cout << endl;
	return 0;
}
```