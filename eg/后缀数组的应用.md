### 后缀数组的应用

#### 后缀数组
- sa[i] 排名为 i 的后缀的起始下标
- rank[i] 下标为 i 的后缀的排名
- height[i] 排名为 i 和 i-1 的后缀的LCP

> height 数组性质: 排名 i 和排名 j (i < j) 的LCP为$min\{height[k] \ | \ k \in  [i+1, j] \}$ , 于是在这个区间内共有$j-i$组以LCP为前缀的后缀
> 
> (当两个后缀排名越是相近才越容易得到相对更长的LCP)
> 
> 在同一组内的后缀有一个公共的LCP, 且不同组内没有公共LCP

***

#### 应用
问题 | 方法 | 例题
--- | --- | ---
求满足某些条件的最长子串 | 二分最长子串长度, 对于是否重叠问题只要判断一下sa之间的距离是否大于所枚举的长度即可 | POJ - 1743 / POJ - 3261 / POJ - 3294 / SPOJ - PHRASES / POJ - 1226
求某些条件下不同子串数 | height分组，单调栈维护同一组内以当前排名的height最小值的范围，统计计算子串个数 | POJ - 3415 
求重复k次的子串数 | 对k分组, 计算每组至少k次的子串数扣掉至少k+1次的子串数 | HDU - 6194 
求**循环**次数最多的子串 | 枚举循环节长度，并将主串按长度分块，根据RMQ计算计算每块的起点与循环节长度处的LCP， 计算左右分别能匹配多远 | SPOJ - REPEATS / POJ - 3693
求**回文**子串 | 正逆序拼接，求跨立两串的LCP | UVA - 11475 

 